EMR_COLORMATCHTOTARGETW stack buffer overflow exploit
By Ac!dDrop

This is one of the 2 Vulnerabilities of MS08-021

Tested on Windows xp professional SP1
GDi32.dll    5.1.2600.1106
kernel32.dll 5.1.2600.1106
ws2_32.dll   5.1.2600.0

calc.zip---> executes calculator
IE.zip and localhost.zip ------>  connects at localhost at port 230


On Windows Xp Sp2 only causes Denial of service.
 -(Vulnerable function guarded with a GS cookie)
 -(The function which copies data to stack has an exception handler which recovers from access violations so u cant exploit it by hitting next page ).

https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/6656.tgz (2008-Gdi.tgz)

# milw0rm.com [2008-10-02]
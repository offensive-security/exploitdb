Application:   XnView FlashPix Image Processing Heap Overflow

Platforms:   Windows

Secunia:   SA47388

{PRL}:   2012-06

Author:   Francis Provencher (Protek Research Lab's)

Website:   http://www.protekresearchlab.com/

Twitter:   @ProtekResearch


#####################################################################################

1) Introduction
2) Report Timeline
3) Technical details
4) The Code


#####################################################################################

===============
1) Introduction
===============
XnView is a cross-platform image viewer used for viewing, converting, organising and editing graphical & video files.
It is free of charge for private, educational and non-profit organisations. For commercial use and distribution,
the user must register the program. It is popular with users as it provides features normally found only
in commercial image viewers.

(http://en.wikipedia.org/wiki/XnView)

#####################################################################################

============================
2) Report Timeline
============================

2012-01-05  Vulnerability reported to Secunia
2012-03-12  Vendor disclose patch


#####################################################################################

============================
3) Technical details
============================
The vulnerability is caused due to an error when processing FPX images, which can be exploited to cause
an heap-based buffer overflow by tricking a user into opening a specially crafted image file.

#####################################################################################

===========
4) The Code
===========

Here: http://www.protekresearchlab.com/exploits/PRL-2012-06.fpx
Mirror: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/18586.pfx (PRL-2012-06.fpx)